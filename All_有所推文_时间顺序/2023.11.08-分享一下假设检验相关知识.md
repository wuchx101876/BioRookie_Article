>> **今天分享一下假设检验的相关内容**，上午在微博看到下面这条消息，觉得自己应该系统复习一下假设检验相关知识，顺便计算一下这个事情是巧合的概率。
![](https://files.mdnice.com/user/23696/171f5174-2b1d-4764-b58e-56885291b82f.png)博主这里有个逻辑错误，200人的规模是过去14年的总和，确诊患病的都是2023年的。

#### 先了解/复习一下假设检验相关内容，下面是我之前在B站学习医学统计学的笔记，需要的小伙伴也可以发给你们。

![](https://files.mdnice.com/user/23696/512a5c9b-60fe-4b6f-9b14-0edf986d7f92.png)


## 假设检验

**假设检验(hypothesis testing)** ，又称统计假设检验，是用来判断样本与样本、样本与总体的差异是由抽样误差引起还是本质差别造成的统计推断方法。 **常用的假设检验方法有t检验、Z检验、卡方检验、F检验等。**

##### 1、建设检验的基本步骤
	（1）建立检验假设，确定检验水准
		零假设(null hypothesis)，又称原假设，记为H0
		对立假设(alternative hypothesis)，又称备择假设，记为H1
	（2）选择并计算检验统计量
##### 2、 确定P值，做出推断
##### 3、 P值的意义：在零假设成立的条件下，出现“统计量当前值及更不利于零假设的数值”的概率为P
	（1）若统计量大于等于当前值，就拒绝零假设，则犯假阳性错误的概率为P
	（2）规定一个“小”的概率 σ ，称检验水准(size of a test)	
	（3）如果P小于等于 σ ，表明“不大可能”犯假阳性错误
	（4）如果P大于 σ ，表明“颇有可能”犯假阳性错误
##### 4、假设检验的两类错误
	（1）第I类错误(type I error) ：假阳性错误
	（2）第II类错误(type II error) ：假阴性错误

### t检验

![单样本](https://files.mdnice.com/user/23696/ea883711-1eb8-4e90-b321-d137ba64706b.png)

![双样本](https://files.mdnice.com/user/23696/e547fdb3-92f2-42b1-92de-7c182a36f16f.png)

### z检验
用于检验总体均值是否等于一个特定的值，但是要求样本容量足够大，以使得样本均值的分布接近正态分布，可以使用标准正态分布进行近似。

### 卡方检验：
用于检验两个或多个分类变量之间的独立性或相关性。

### F检验（方差齐性检验）
通常用于比较两个或多个总体方差是否相等

#### 从上面可以看出，**卡方检验适用于“患癌和在某个组是否相关”的情况**

## 卡方检验

**卡方检验（Chi-Square Test）**是一种用于检验两个或多个分类变量之间的独立性或相关性的统计方法。它适用于离散型数据，可以用于比较实际观测值与期望的理论值之间的差异。

卡方检验分为两种类型：卡方独立性检验和卡方拟合度检验。

![](https://files.mdnice.com/user/23696/e3a595ff-9b1e-4448-93b3-ef73c9b707be.png)

检验过程

![](https://files.mdnice.com/user/23696/cbd06a47-e446-4463-b2e9-660962dbbb05.png)

举个例子，化妆和性别之间的关系

![](https://files.mdnice.com/user/23696/ecd74750-dac4-4d9e-8816-088b5cf198a0.png)

#### 好了，我们现在学会了卡方检验，可以计算一下这个事情的概率了

## 患癌与在某组是否相关

2023年有三人确诊患病

![](https://files.mdnice.com/user/23696/282a0c9c-98a0-4a9f-a215-1a8468bffed0.png)

根据研究中心的介绍，中心团队一共有59人

![](https://files.mdnice.com/user/23696/bfcae354-d60b-4a88-8ec2-89e68af1a0b1.png)

中国肿瘤发生概率，来源2022年发表的中国癌症研究报告。链接：https://www.sciencedirect.com/science/article/pii/S2667005422000047


![不同年龄阶段发病率](https://files.mdnice.com/user/23696/a9a893aa-8aba-444f-a97c-9399d13bde43.png)

![前五名癌症发病率](https://files.mdnice.com/user/23696/f4f24b35-beaa-464a-9996-5d6ed6628dc0.png)

### 简单粗暴的计算一下

根据按照15~44岁间所有肿瘤发病率，404/100000计算

#### 使用R语言中的chisq.test()函数进行卡方检验，也可以手动计算

```r
data <- data.frame(matrix(c(3,404,59,100000),nrow = 2,ncol = 2))
colnames(data) <- c("cancer","Uncancer")
rownames(data) <- c("lab","Unlab")
chisq.test(data)
```

![数据](https://files.mdnice.com/user/23696/23d98f42-9fe9-47d7-9358-40b65ad610d2.png)

**X-squared = 20.229，p-value = 6.87e-06**，结果很显著，从结果看两者之间是高度相关的。

![结果](https://files.mdnice.com/user/23696/9bce9aeb-5938-421c-84ca-3da246728dac.png)

#### 当然这样计算存在一些问题，没有考虑。

- 患病人员是否都在同一个课题组，中心一共59人不太可能都在一个课题组，如果考虑课题组人员的分配，X-squared只会更大。
- 患病人员是否属于在职的59人里面，这里我从宽计算，未将其列在其中。
- 网传还有6人做检查不知道是真是假，这点无从考证，暂未考虑。
- 网传三者所得癌症类型都属于罕见型（罕见癌症发病率远低于所有癌症放一起的发病率），目前只能确定一个，如果考虑到罕见癌的发病率，X-squared也只会更大。
- ......（其它一些未考虑的情况）

#### 以上仅仅是计算分析，没有立场和结论。。

最后希望做实验的小伙伴都能注意安全，做好防护。生物专业本来工作就不好找，保证身体健康才是最重要的。
