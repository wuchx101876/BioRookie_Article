在做差异分析的时候，我们经常听到**Counts、FPKM、TPM**值，介绍一下这三个值到底是怎么计算出来的，以及各自的使用场景。

## 1、Counts值
#### 1、Counts 值（reads计数值）：
Counts 值表示每个基因在样本中的reads计数，即测序数据中映射到每个基因的测序reads的数量。Counts 值是最直接的基因表达量测量，它反映了基因在样本中的丰度。**Counts 值的计算通常基于原始测序数据（FASTQ 文件），通过将读取与参考基因组或转录组进行比对来进行计数。**

有counts值之后，为啥还需要FPKM和TPM值呢，因为**counts值之间没有比较的意义**，例如：下表是A,B,C,D四个基因在3个样本中的read counts，能否直接比较？显然不可以，**主要受两个因素影响**：
| Gene_name   |   Sample1  | Sample2      |  Sample3  |
| :---------: |  :-------: | :-----------:| :-----:   |
| A (1kb)     |     10     |      17      |      28     |
| B (4kb)     |     35     |      0       |      40     |
| C (5kb)     |     19     |     16       |     15      |
|D (10kb)     |     167    |      89      |     115      |
|total reads  |     231    |     122      |     198      |

- **1、基因长度的影响。**在同一个样本中，基因越长，随机打断得到的片段就越多，该基因被测到的概率就越大，比对到该基因的reads就越多。
- **2、测序深度的影响。**不同样本中，样本的测序深度越高，同一基因被测到的次数越多，比对到该基因的reads就越多。因此FPKM值和TPM值就是为了消除或弱化这种影响。

## 2、FPKM值

#### 1、FPKM 值（每千碱基转录本数每百万映射读取数）
**FPKM（Fragments Per Kilobase of transcript per Million mapped reads）**是一种常用的基因表达量归一化方法。FPKM 值将基因的表达量调整为每千碱基转录本数每百万映射读取数。它与 TPM 值类似，但考虑了测序读取的映射率。FPKM 值将每个基因的 Counts 值除以其长度和样本中总的映射读取数，并进行适当的归一化。

**计算过程：**

![](https://files.mdnice.com/user/23696/b61362ee-b0fc-4714-ac49-a55557a85131.png)

#### 2、计算一下刚刚的例子，为了方便显示，将每百万（10^6）转录被，改成每百（100）转录本，计算的FPKM值如下：
| Gene_name   |   Sample1  | Sample2      |  Sample3  |
| :---------: |  :-------: | :-----------:| :-----:   |
| A (1kb)     |    4.33     |      13.93      |     14.14     |
| B (4kb)     |    3.79     |      0       |      5.05     |
| C (5kb)     |    1.65     |    2.62 |	1.52      |
|D (10kb)     |    7.23   |      7.3	| 5.81     |
|total FPKM  |     17    |      23.85	| 26.52     |

虽然FPKM值考虑了基因长度的差异，但是由于不同样本测序深度的差异，总的FPKM值并不相同，**因此不能用于样本间的直接比较。** TMP值在一定程度上改善了这个问题。

## 3、TPM值

#### 1、TPM 值（每百万转录本数）
**TPM（Transcripts Per Million）** 是一种常用的基因表达量归一化方法，它将基因的表达量调整为每百万条转录本的数量。TPM 值考虑了基因的长度和测序深度，通过将每个基因的 Counts 值除以其长度，并进行适当的归一化，将基因的表达量转换为每百万转录本数，以便进行样本间的比较和分析。**TPM 值消除了样本间测序深度的差异和基因长度的影响。**
![](https://files.mdnice.com/user/23696/40702d49-3c23-4fca-9c1a-eb05f1af064d.png)
**一个样本中某基因的TPM值的计算方法：** 先对每个基因的read数用基因的长度进行校正，获得此基因校正后的值(counts_i/Length_i)，然后将所有基因矫正后的值之和(sum(counts_i/Length_i)+ …… + (counts_m/Length_m ))除以1000000，获得“每百万”Reads的比例因子。最后用基因校正后的值除以这个比例因子就可以得到该基因的TPM值了。

#### 2、计算一下刚刚的例子，为了方便显示，将每百万（10^6）转录被，改成每百（100）转录本，计算的TPM值如下：

| Gene_name   |   Sample1  | Sample2      |  Sample3  |
| :---------: |  :-------: | :-----------:| :-----:   |
| A (1kb)     |    25.48	|58.42|	53.33 |
| B (4kb)     |    22.29	|0	|19.05    |
| C (5kb)     |   9.68	|11	|5.72      |
|D (10kb)     |    42.55|	30.58|	21.90    |
|total TPM    |     100	|100|	100     |

可以看到不同样本间，TPM值之和是相等的，因此可以**直接用于不同样本间基因的比较**。







